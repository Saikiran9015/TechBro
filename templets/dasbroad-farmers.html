<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Farmer Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --green: #2f7d32;
      --dark-green: #166534;
      --white: #fff;
      --muted: #f2f7f1;
      --text: #13321f
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: var(--muted);
      color: var(--text);
      padding: 20px
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 14px;
      margin-top: 18px
    }

    .card {
      background: var(--white);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid rgba(22, 101, 52, 0.06)
    }

    img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 6px
    }

    .muted {
      color: #666
    }

    .btn {
      background: var(--green);
      color: var(--white);
      padding: 8px 10px;
      border-radius: 6px;
      border: none;
      cursor: pointer
    }
  </style>
</head>

<body>
  <div class="header">
    <h2>My Products</h2>
    <div><a href="/seller-dashboard/add" class="btn">Add Product</a></div>
  </div>

  {% set _placeholder = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="180">
    <rect width="100%" height="100%" fill="%23f2f7f1" /><text x="50%" y="50%" dominant-baseline="middle"
      text-anchor="middle" fill="%23166334" font-family="Poppins, Arial" font-size="14">No Image</text>
  </svg>' %}
  {% if products %}
  <div class="grid">
    {% for p in products %}
    <div class="card">
      {% set imgsrc = p.image or _placeholder %}
      <img src="{{ imgsrc }}" alt="{{ p.name }}">
      <div style="font-weight:700;color:var(--dark-green);margin-top:8px">{{ p.name }}</div>
      <div class="muted">{{ p.category }}</div>
      <div style="margin-top:6px;font-weight:700;color:var(--green)">₹{{ p.adjusted_price }} <small
          style="color:#666;font-weight:400">(base ₹{{ p.price }})</small></div>
      <div style="margin-top:6px;color:#666">Quality: {{ p.quality_score }}</div>
      {% if p.quantity is defined %}
      <div style="margin-top:4px;font-weight:700;color: {{ '#dc2626' if p.quantity <= 0 else '#666' }}">
        Stock: {{ p.quantity if p.quantity > 0 else 'OUT OF STOCK' }}
      </div>
      {% endif %}
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p class="muted">You have no products yet. <a href="/seller-dashboard/add">Add one</a></p>
  {% endif %}

</body>

</html>